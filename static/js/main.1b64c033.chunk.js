(this.webpackJsonpexcel_to_json=this.webpackJsonpexcel_to_json||[]).push([[0],{142:function(e,t,n){},143:function(e,t,n){},147:function(e,t){},148:function(e,t){},176:function(e,t){},178:function(e,t){},188:function(e,t){},190:function(e,t){},217:function(e,t){},219:function(e,t){},220:function(e,t){},225:function(e,t){},227:function(e,t){},246:function(e,t){},258:function(e,t){},261:function(e,t){},269:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n.n(c),i=n(36),o=n.n(i),s=(n(142),n.p,n(143),n(14)),r=n(30),l=n.n(r),j=n(71),u=n(39),d=n.n(u),h=n(38),b=n(0),f=function(e){var t=e.tableData,n=Object(c.useState)([]),a=Object(s.a)(n,2),i=a[0],o=a[1];Object(c.useEffect)((function(){fetch("https://629224419d159855f0865064.mockapi.io/testapi").then((function(e){o(e.json())})).then((function(e){console.log(e.title)}))}),[]);return Object(b.jsx)(b.Fragment,{children:Object(b.jsx)("div",{children:0!=t.length&&void 0!==t[0]&&Object(b.jsxs)("table",{class:"table table-responsive",children:[Object(b.jsx)("thead",{children:Object(b.jsxs)("tr",{children:[Object(b.jsx)("th",{scope:"col",children:"PartyName"}),Object(b.jsx)("th",{scope:"col",children:"Bill"}),Object(b.jsx)("th",{scope:"col",children:"Cash"}),Object(b.jsx)("th",{scope:"col",children:"TotalAmount"}),window.innerWidth>800&&Object(b.jsx)("th",{scope:"col",children:"Message"})]})}),Object(b.jsx)("tbody",{children:t.map((function(e,t){var n=e.PartyName,c=e.Bill,a=e.Cash,o=e.TotalAmount;return Object(b.jsxs)("tr",{children:[Object(b.jsx)("th",{onClick:function(){return function(e,t,n){var c="Dear Sir,\n    an amount is Due\n    BILL Rs *".concat(0==t?"00":t,"*\n    CASH Rs *").concat(0==n?"00":n,"*\n    please take into consideration");encodeURI(c),0!==i.length&&i.find((function(t){var n=t.NAME,a=t.NUMBER;"Name NaN"!==n&&n==e&&window.open("https://wa.me/91".concat(a,"?text=").concat(encodeURI(c)),"_blank")}))}(n,c,a)},className:"pointer",children:n}),Object(b.jsx)("td",{children:c}),Object(b.jsx)("td",{children:a}),Object(b.jsx)("td",{children:o}),window.innerWidth>800&&Object(b.jsx)("td",{children:Object(b.jsxs)("div",{id:"copy".concat(t),className:"pointer",onClick:function(){return function(e){var t=document.createRange();t.selectNode(document.getElementById(e)),window.getSelection().removeAllRanges(),window.getSelection().addRange(t),document.execCommand("copy"),window.getSelection().removeAllRanges(),Object(h.b)("copy to clipboard")}("copy".concat(t))},children:[Object(b.jsx)("div",{children:"Dear Sir,"}),Object(b.jsx)("div",{children:"an amount is Due"}),Object(b.jsxs)("div",{children:["BILL Rs *",0==c?"00":c,"*"]}),Object(b.jsxs)("div",{children:["CASH Rs *",0==a?"00":a,"*"]}),Object(b.jsx)("div",{children:"please take into consideration"})]})})]},t)}))})]})})})},O=function(e){var t=e.withData,n=e.withOutData,a=Object(c.useState)([]),i=Object(s.a)(a,2),o=i[0],r=i[1],l=Object(c.useState)([]),u=Object(s.a)(l,2),h=u[0],O=u[1];function m(e){for(var t={},n=0;n<e.length;n++){var c=e[n];for(var a in c)t[a]||(t[a]=c[a])}return t}Object(c.useEffect)((function(){var e=[];0!=h.length&&h.map((function(t){var n=t.name,c=t.amt,a=t.amt1;(void 0==a?0:parseInt(a))+(void 0==c?0:parseInt(c))!=0&&e.push({PartyName:n,Bill:void 0==a?0:parseInt(a),Cash:void 0==c?0:parseInt(c),TotalAmount:(void 0==a?0:parseInt(a))+(void 0==c?0:parseInt(c))})})),e.sort((function(e,t){return e.PartyName>t.PartyName?1:t.PartyName>e.PartyName?-1:0}));var t=e.findIndex((function(e){return"Grand Total"==e.PartyName}));e.push(e.splice(t,1)[0]),r(e),console.log(e)}),[h]);var x=new Date,p=["01","02","03","04","05","06","07","08","09","10","11","12"][x.getMonth()],v=String(x.getDate()).padStart(2,"0")+"/"+p+"/"+x.getFullYear(),g=d.a.ExcelFile,y=d.a.ExcelFile.ExcelSheet,w=d.a.ExcelFile.ExcelColumn;return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)("div",{className:"my-3",children:[Object(b.jsx)("button",{className:"btn btn-primary  mx-3",onClick:function(){return function(e,t){for(var n=[].concat(Object(j.a)(e),Object(j.a)(t)),c={},a=[],i=0;i<n.length;i++){var o=n[i],s=o.name;c[s]||(c[s]=[]),c[s].push(o)}for(var r in c)a.push(m(c[r]));O(a)}(t,n)},children:"Merge"}),Object(b.jsx)(g,{filename:"Payment Details-".concat(v),children:Object(b.jsxs)(y,{data:o,name:"customer",children:[Object(b.jsx)(w,{label:"PartyName",value:"PartyName"}),Object(b.jsx)(w,{label:"Bill",value:"Bill"}),Object(b.jsx)(w,{label:"Cash",value:"Cash"}),Object(b.jsx)(w,{label:"TotalAmount",value:"TotalAmount"})]})})]}),Object(b.jsx)(f,{tableData:o})]})},m=n(70),x=function(){var e=Object(c.useState)([]),t=Object(s.a)(e,2),n=t[0],a=t[1],i=Object(c.useState)([]),o=Object(s.a)(i,2),r=o[0],j=o[1],u=function(e,t){!function(e,t){var n=new FileReader,c=!!n.readAsBinaryString;n.onload=function(e){var n=e.target.result,i=l.a.read(n,{type:c?"binary":"array",bookVBA:!0}),o=i.SheetNames[0],s=i.Sheets[o];"withData"==t?a(l.a.utils.sheet_to_json(s)):"withOutData"==t&&j(l.a.utils.sheet_to_json(s))},c?n.readAsBinaryString(e):n.readAsArrayBuffer(e)}(e.target.files[0],t)};return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)("div",{className:"input_field",children:[Object(b.jsxs)("div",{children:[Object(b.jsx)("label",{htmlFor:"file",children:"With File "}),Object(b.jsx)("input",{type:"file",className:"form-control",id:"file",accept:m.SheetJSFT,onChange:function(e){return u(e,"withData")}})]}),Object(b.jsxs)("div",{children:[Object(b.jsx)("label",{htmlFor:"file1",children:"With Out File "}),Object(b.jsx)("input",{type:"file",className:"form-control",id:"file1",accept:m.SheetJSFT,onChange:function(e){return u(e,"withOutData")}})]})]}),Object(b.jsx)(O,{withData:n,withOutData:r})]})};n(267),n(268);var p=function(){return Object(b.jsxs)("div",{className:"App",children:[Object(b.jsx)(x,{}),Object(b.jsx)(h.a,{pauseOnFocusLoss:!1,autoClose:3e3})]})},v=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,270)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,i=t.getLCP,o=t.getTTFB;n(e),c(e),a(e),i(e),o(e)}))};o.a.render(Object(b.jsx)(a.a.StrictMode,{children:Object(b.jsx)(p,{})}),document.getElementById("root")),v()},70:function(e,t){["xlsx","xlsb","xlsm","xls","xml","csv","txt","ods","fods","uos","sylk","dif","dbf","prn","qpw","123","wb*","wq*","html","htm"].map((function(e){return"."+e})).join(",")},74:function(e,t){}},[[269,1,2]]]);
//# sourceMappingURL=main.1b64c033.chunk.js.map