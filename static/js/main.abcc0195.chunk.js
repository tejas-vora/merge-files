(this.webpackJsonpexcel_to_json=this.webpackJsonpexcel_to_json||[]).push([[0],{143:function(t,e,n){},144:function(t,e,n){},149:function(t,e){},150:function(t,e){},178:function(t,e){},180:function(t,e){},192:function(t,e){},194:function(t,e){},221:function(t,e){},223:function(t,e){},224:function(t,e){},229:function(t,e){},231:function(t,e){},250:function(t,e){},262:function(t,e){},265:function(t,e){},273:function(t,e,n){"use strict";n.r(e);var c=n(1),a=n.n(c),i=n(37),o=n.n(i),r=(n(143),n.p,n(144),n(14)),s=n(21),l=n.n(s),u=n(31),j=n(40),d=n.n(j),h=n(72),b=n(138),f=n(39),O=n(0),m=function(t){var e=t.tableData,n=t.jsonData,a=t.setJsonData,i=t.jsonData1,o=t.setJsonData1;Object(c.useEffect)(Object(b.a)(Object(h.a)().mark((function t(){return Object(h.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://629224419d159855f0865064.mockapi.io/testapi").then((function(t){return t.json()})).then((function(t){return a(t)})).catch((function(t){return console.log(t)}));case 2:return t.next=4,fetch("https://629224419d159855f0865064.mockapi.io/test1api").then((function(t){return t.json()})).then((function(t){return o(t)})).catch((function(t){return console.log(t)}));case 4:case"end":return t.stop()}}),t)}))),[]);return Object(O.jsx)(O.Fragment,{children:Object(O.jsx)("div",{children:0!=e.length&&void 0!==e[0]&&Object(O.jsxs)("table",{class:"table table-responsive",children:[Object(O.jsx)("thead",{children:Object(O.jsxs)("tr",{children:[Object(O.jsx)("th",{scope:"col",children:"PartyName"}),Object(O.jsx)("th",{scope:"col",children:"Bill"}),Object(O.jsx)("th",{scope:"col",children:"Cash"}),Object(O.jsx)("th",{scope:"col",children:"TotalAmount"}),window.innerWidth>800&&Object(O.jsx)("th",{scope:"col",children:"Message"})]})}),Object(O.jsx)("tbody",{children:e.map((function(t,e){var c=t.PartyName,a=t.Bill,o=t.Cash,r=t.TotalAmount;return Object(O.jsxs)("tr",{children:[Object(O.jsx)("th",{onClick:function(){return function(t,e,c){var a="Dear Sir,\n    an amount is Due\n    ".concat(0!=e&&"BILL Rs *".concat(e,"*"),"\n    ").concat(0!=c&&"CASH Rs *".concat(c,"*"),"\n    please take into consideration");encodeURI(a),0!==n.length&&n.find((function(e){var n=e.NAME,c=e.NUMBER;n==t&&window.open("https://wa.me/91".concat(c,"?text=").concat(encodeURI(a)),"_blank")})),0!==i.length&&i.find((function(e){var n=e.NAME,c=e.NUMBER;n==t&&window.open("https://wa.me/91".concat(c,"?text=").concat(encodeURI(a)),"_blank")}))}(c,a,o)},className:"pointer",children:c}),Object(O.jsx)("td",{children:a}),Object(O.jsx)("td",{children:o}),Object(O.jsx)("td",{children:r}),window.innerWidth>800&&Object(O.jsx)("td",{children:Object(O.jsxs)("div",{id:"copy".concat(e),className:"pointer",onClick:function(){return function(t){var e=document.createRange();e.selectNode(document.getElementById(t)),window.getSelection().removeAllRanges(),window.getSelection().addRange(e),document.execCommand("copy"),window.getSelection().removeAllRanges(),Object(f.b)("copy to clipboard")}("copy".concat(e))},children:[Object(O.jsx)("div",{children:"Dear Sir,"}),Object(O.jsx)("div",{children:"an amount is Due"}),0!=a&&Object(O.jsxs)("div",{children:["BILL Rs *",0==a?"00":a,"*"]}),0!=o&&Object(O.jsxs)("div",{children:["CASH Rs *",0==o?"00":o,"*"]}),Object(O.jsx)("div",{children:"please take into consideration"})]})})]},e)}))})]})})})},x=function(t){var e=t.withData,n=t.withOutData,a=Object(c.useState)([]),i=Object(r.a)(a,2),o=i[0],s=i[1],l=Object(c.useState)([]),j=Object(r.a)(l,2),h=j[0],b=j[1],f=Object(c.useState)([]),x=Object(r.a)(f,2),p=x[0],v=x[1],g=Object(c.useState)([]),w=Object(r.a)(g,2),N=w[0],y=w[1];function D(t){for(var e={},n=0;n<t.length;n++){var c=t[n];for(var a in c)e[a]||(e[a]=c[a])}return e}Object(c.useEffect)((function(){var t=[],e=[].concat(Object(u.a)(p),Object(u.a)(N)),n=[];0!=h.length&&h.map((function(c){var a=c.name,i=c.amt,o=c.amt1;(void 0==o?0:parseInt(o))+(void 0==i?0:parseInt(i))!=0&&(0!==e.length&&(n=e.find((function(t){var e=t.NAME,n=t.NUMBER;if(e===a)return n}))),t.push({PartyName:a,Bill:void 0==o?0:parseInt(o),Cash:void 0==i?0:parseInt(i),ContactNumbe:void 0!==n?n.NUMBER:"",TotalAmount:(void 0==o?0:parseInt(o))+(void 0==i?0:parseInt(i))}))})),t.sort((function(t,e){return t.PartyName>e.PartyName?1:e.PartyName>t.PartyName?-1:0}));var c=t.findIndex((function(t){return"Grand Total"==t.PartyName}));t.push(t.splice(c,1)[0]),s(t)}),[h]);var S=new Date,C=["01","02","03","04","05","06","07","08","09","10","11","12"][S.getMonth()],F=String(S.getDate()).padStart(2,"0")+"/"+C+"/"+S.getFullYear(),A=d.a.ExcelFile,B=d.a.ExcelFile.ExcelSheet,E=d.a.ExcelFile.ExcelColumn;return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsxs)("div",{className:"my-3",children:[Object(O.jsx)("button",{className:"btn btn-primary  mx-3",onClick:function(){return function(t,e){for(var n=[].concat(Object(u.a)(t),Object(u.a)(e)),c={},a=[],i=0;i<n.length;i++){var o=n[i],r=o.name;c[r]||(c[r]=[]),c[r].push(o)}for(var s in c)a.push(D(c[s]));b(a)}(e,n)},children:"Merge"}),Object(O.jsx)(A,{filename:"Payment Details-".concat(F),children:Object(O.jsxs)(B,{data:o,name:"customer",children:[Object(O.jsx)(E,{label:"PartyName",value:"PartyName"}),Object(O.jsx)(E,{label:"Bill",value:"Bill"}),Object(O.jsx)(E,{label:"Cash",value:"Cash"}),Object(O.jsx)(E,{label:"TotalAmount",value:"TotalAmount"}),Object(O.jsx)(E,{label:"ContactNumbe",value:"ContactNumbe"})]})})]}),Object(O.jsx)(m,{tableData:o,jsonData:p,setJsonData:v,jsonData1:N,setJsonData1:y})]})},p=n(71),v=function(){var t=Object(c.useState)([]),e=Object(r.a)(t,2),n=e[0],a=e[1],i=Object(c.useState)([]),o=Object(r.a)(i,2),s=o[0],u=o[1],j=function(t,e){!function(t,e){var n=new FileReader,c=!!n.readAsBinaryString;n.onload=function(t){var n=t.target.result,i=l.a.read(n,{type:c?"binary":"array",bookVBA:!0}),o=i.SheetNames[0],r=i.Sheets[o];"withData"==e?a(l.a.utils.sheet_to_json(r)):"withOutData"==e&&u(l.a.utils.sheet_to_json(r))},c?n.readAsBinaryString(t):n.readAsArrayBuffer(t)}(t.target.files[0],e)};return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsxs)("div",{className:"input_field",children:[Object(O.jsxs)("div",{children:[Object(O.jsx)("label",{htmlFor:"file",children:"With File "}),Object(O.jsx)("input",{type:"file",className:"form-control",id:"file",accept:p.SheetJSFT,onChange:function(t){return j(t,"withData")}})]}),Object(O.jsxs)("div",{children:[Object(O.jsx)("label",{htmlFor:"file1",children:"With Out File "}),Object(O.jsx)("input",{type:"file",className:"form-control",id:"file1",accept:p.SheetJSFT,onChange:function(t){return j(t,"withOutData")}})]})]}),Object(O.jsx)(x,{withData:n,withOutData:s})]})};n(271),n(272);var g=function(){return Object(O.jsxs)("div",{className:"App",children:[Object(O.jsx)(v,{}),Object(O.jsx)(f.a,{pauseOnFocusLoss:!1,autoClose:3e3})]})},w=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,274)).then((function(e){var n=e.getCLS,c=e.getFID,a=e.getFCP,i=e.getLCP,o=e.getTTFB;n(t),c(t),a(t),i(t),o(t)}))};o.a.render(Object(O.jsx)(a.a.StrictMode,{children:Object(O.jsx)(g,{})}),document.getElementById("root")),w()},71:function(t,e){["xlsx","xlsb","xlsm","xls","xml","csv","txt","ods","fods","uos","sylk","dif","dbf","prn","qpw","123","wb*","wq*","html","htm"].map((function(t){return"."+t})).join(",")},74:function(t,e){}},[[273,1,2]]]);
//# sourceMappingURL=main.abcc0195.chunk.js.map